# 08. HTTP 헤더 2 - 캐시와 조건부 요청

## 8.1. 캐시 기본 동작

먼저, 캐시가 없는 상황에 대해 알아보겠습니다.

다음와 같이 웹 브라우저에서 `star.jpg`를 요청하면, 서버는 `star.jpg`를 내려줍니다.
이 때 HTTP 헤더를 0.1M, HTTP 바디를 1.0M라고 가정하면, 1.1M의 네트워크를 차지하며 웹 브라우저에 응답 데이터가 내려옵니다.
그러면 웹 브라우저 내에 이미지가 표출되게 됩니다.

<img width="512" alt="image" src="https://github.com/Kim-SuBin/TIL/assets/46712693/d8c6f4dc-0088-4c01-9b58-f46831e72c9c">

그리고 `star.jpg`를 다시 요청하면, 서버로부터 1.1M의 네트워크를 차지하며 이미지가 응답 데이터로 내려옵니다.

<img width="370" alt="image" src="https://github.com/Kim-SuBin/TIL/assets/46712693/cbc9ac79-a102-4211-823b-7f54ee736687">

이렇듯 캐시가 없으면, **데이터가 변경되지 않아도 계속 네트워크를 통해 데이터를 다운로드 받아야 합니다.**
그런데 이러한 인터넷 네트워크는 **매우 느리고 비쌉니다.**
뿐만 아니라, 매번 데이터를 받아오는 것은 브라우저의 **로딩 속도를 느리게** 만들고,
사용자는 **느린 경험**을 하게 됩니다. 

요약하여 정리하면 **캐시가 없을 때의 특징**은 다음과 같습니다.

- 데이터가 변경되지 않아도 계속 네트워크를 통해 데이터를 다운로드 받아야 함
- 인터넷 네트워크는 매우 느리고 비쌈
- 브라우저 로딩 속도가 느림
- 느린 사용자 경험

이번에는 캐시를 적용하면 어떻게 되는지 알아보겠습니다.

이전과 동일하게 웹 브라우저는 `star.jpg`를 요청하며, 서버는 `star.jpg`를 내려줍니다.
이 때, 헤더 내에 `cache-control`이라고 하는 **캐시 정보**를 포함합니다.
그러면 웹 브라우저는 `star.jpg`를 캐시에 저장합니다.

<img width="345" alt="image" src="https://github.com/Kim-SuBin/TIL/assets/46712693/e9140144-7326-4500-b32b-30db10efd9a2">

두 번째 요청이 `cache-control`에서 지정한 60초라는 시간 내에 들어오면,
다음과 같이 서버가 아닌 캐시에서 `star.jpg`를 가져옵니다.

<img width="368" alt="image" src="https://github.com/Kim-SuBin/TIL/assets/46712693/0ca4aa8b-4f27-41e7-9f6c-ab09d253bd58">

이렇듯, 캐시를 적용하면 **네트워크를 사용하지 않아도 되어서** 비싼 네트워크 사용량을 줄일 수 있습니다.
그리고 이미 불러온 데이터에 대해서는 **브라우저 로딩 속도가 매우 빠르며,**
그로 인해 사용자는 **빠른 사용자 경험**을 하게 됩니다.

요약하여 정리하면 **캐시의 특징**은 다음과 같습니다.

- 캐시 가능 시간 동안 네트워크를 사용하지 않아도 됨
- 비싼 네트워크 사용량을 줄일 수 있음
- 브라우저 로딩 속도가 매우 빠름
- 빠른 사용자 경험

그렇다면 캐시가 유효한 시간이 초과된 이후 요청하면 어떻게 될까요?

다음과 같이 웹 브라우저는 브라우저 캐시가 초과되었는지 확인한 다음, 서버에 요청을 합니다.
그리고 서버는 `star.jpg` 정보와 캐시 유효 시간을 다시 알려줍니다.
그러면 웹 브라우저는 기존 캐시 정보를 지우고, 새로 받은 응답 데이터를 캐시에 저장합니다.

<img width="407" alt="image" src="https://github.com/Kim-SuBin/TIL/assets/46712693/94b37b43-07af-478f-91e6-8b91e5fb62c3">

즉, **캐시 유효 시간이 초과하면 서버를 통해 다시 조회하고 캐시를 갱신**합니다.
이 때 다시 네트워크 다운로드가 발생합니다.

그런데 캐시 만료 이후 받아온 데이터가 이미 캐시 내에 저장된 데이터와 동일하다면, 다시 다운로드를 받을 필요가 있을까요?
이러한 의문을 해결할 수 있는 내용은 아래에 이어서 살펴보도록 하겠습니다.


> 본 게시글은 [모든 개발자를 위한 HTTP 웹 기본 지식](https://www.inflearn.com/course/http-%EC%9B%B9-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/dashboard) 강의를 참고하여 작성되었습니다.
>
> 상세한 내용이 궁금하시다면 강의 수강을 추천해 드립니다.